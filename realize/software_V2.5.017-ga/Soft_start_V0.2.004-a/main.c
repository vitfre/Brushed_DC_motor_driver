/*
 * Delay_line.c
 *
 * Created: 02.02.2014 14:00:29
 *  Author: Администратор
 */ 

#include "main.h"

//****************************************************************************************
// External Interrupt 0 service routine
//****************************************************************************************
ISR (INT0_vect)
{
	//---------------------------------------------------------------------------------------
	if (PWR_EN==0x00)
	{
		IMP_SEM_CLR_M1
	} 
	else
	{
	};
	//---------------------------------------------------------------------------------------
	return;
};

//****************************************************************************************
// Timer0 overflow interrupt service routine
//****************************************************************************************
ISR (TIMER0_OVF_vect)
{
	//---------------------------------------------------------------------------------------
	IMP_SEM_SET_M1
	//---------------------------------------------------------------------------------------
	return;
};

int main(void)
{
	//---------------------------------------------------------------------------------------
	init_periphery ();
	//---------------------------------------------------------------------------------------
	//Global enable interrupts
	sei();
	//---------------------------------------------------------------------------------------
    while(1)
    {
        //TODO:: Please write your application code 
		//---------------------------------------------------------------------------------------
		if (PWR_EN==0x00)
		{
			//---------------------------------------------------------------------------------------
			power++;
			if (power>249)
			{
				power=249;
			};
			//---------------------------------------------------------------------------------------
		}
		else													//Генератор не працює_Лінія відсутня
		{
			//---------------------------------------------------------------------------------------
			SPOP_M1
			//---------------------------------------------------------------------------------------
		};
		//---------------------------------------------------------------------------------------
		_delay_ms(15);
		//---------------------------------------------------------------------------------------
    };
};